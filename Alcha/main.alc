import "Platform/DE0-Nano-SoC" as Platform;
//------------------------------------------------------------------------------

import "Library/Clocking_and_Reset/PLL_CycloneV";

net ResetKey = ~Platform.Keys[0];

PLL_CycloneV(Platform.Clock1, ResetKey, [100, 6.25]) PLL;
alias DspClock     = PLL.Output[0];
alias ControlClock = PLL.Output[1];
//------------------------------------------------------------------------------

import "Library/Clocking_and_Reset/DelayedReset";

net MasterReset = DelayedReset(ControlClock, ResetKey | ~PLL.Locked, 100);
//------------------------------------------------------------------------------

import "SubSystems/SystemController";
//------------------------------------------------------------------------------

import "Library/Interfaces/RegistersDecoder";
RegistersDecoder(SystemController.LightWeightBus) Registers;
//------------------------------------------------------------------------------

import "Library/Misc/FirmwareVersion";
FirmwareVersion(1, 0) Firmware;

Registers.ReadOnly(Firmware.Version);
Registers.ReadOnly(Firmware.Date   );
Registers.ReadOnly(Firmware.Time   );
Registers.ReadOnly(Firmware.GitHash);
//------------------------------------------------------------------------------

import "SubSystems/HardwareControl" as Hardware;
//------------------------------------------------------------------------------

import "SubSystems/MasterTrigger";
//------------------------------------------------------------------------------

import "SubSystems/WaveformGenerator" as Waveform;
//------------------------------------------------------------------------------

import "SubSystems/ReceiverAbstraction" as Receiver;
//------------------------------------------------------------------------------

import "SubSystems/RadarProcessor" as Processor;
//------------------------------------------------------------------------------

import "SubSystems/DataStreamer" as Streamer;
//------------------------------------------------------------------------------

import "SubSystems/DataLogger" as Logger;
//------------------------------------------------------------------------------

Registers.GenerateRegs ();
Registers.GenerateCpp  ("../Software/Registers/Registers");
Registers.GenerateLaTeX("../Documentation/Registers");
//------------------------------------------------------------------------------

